---
import { Image } from "astro:assets";
import logo from "../assets/logo.webp";
---

<nav
  id="navbar"
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 -translate-y-full"
>
  <div
    class="backdrop-blur-md bg-white/80 border-b border-slate-200/50 shadow-lg"
  >
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <!-- Logo -->
        <a href="#hero" class="flex items-center gap-3 group">
          <Image
            src={logo}
            alt="Centro de Descanso Los Poetas"
            class="h-10 w-auto transition-transform group-hover:scale-105"
            loading="eager"
            widths={[40]}
          />
          <span
            class="hidden md:block text-slate-800 font-semibold text-sm max-w-[200px] leading-tight"
          >
            Centro de Descanso<br />Los Poetas
          </span>
        </a>

        <!-- Desktop Navigation -->
        <div class="hidden md:flex items-center gap-8">
          <a
            href="#experience"
            class="text-slate-700 hover:text-emerald-600 transition-colors font-medium text-sm"
          >
            Experiencia
          </a>
          <a
            href="#cabañas"
            class="text-slate-700 hover:text-emerald-600 transition-colors font-medium text-sm"
          >
            Cabañas
          </a>
          <a
            href="#galeria"
            class="text-slate-700 hover:text-emerald-600 transition-colors font-medium text-sm"
          >
            Galería
          </a>
          <a
            href="#politicas"
            class="text-slate-700 hover:text-emerald-600 transition-colors font-medium text-sm"
          >
            Políticas
          </a>
          <a
            href="https://wa.me/56952299793"
            target="_blank"
            class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-full transition-colors text-sm font-medium"
          >
            Reservar
          </a>
        </div>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="md:hidden p-2 text-slate-700 hover:text-emerald-600 transition-colors"
          aria-label="Menú"
        >
          <svg
            id="menu-icon"
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg
            id="close-icon"
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 hidden"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="md:hidden backdrop-blur-md bg-white/95 border-b border-slate-200/50 shadow-lg hidden"
  >
    <div class="container mx-auto px-4 py-4 space-y-3">
      <a
        href="#experience"
        class="block text-slate-700 hover:text-emerald-600 transition-colors font-medium py-2 mobile-menu-link"
      >
        Experiencia
      </a>
      <a
        href="#cabañas"
        class="block text-slate-700 hover:text-emerald-600 transition-colors font-medium py-2 mobile-menu-link"
      >
        Cabañas
      </a>
      <a
        href="#galeria"
        class="block text-slate-700 hover:text-emerald-600 transition-colors font-medium py-2 mobile-menu-link"
      >
        Galería
      </a>
      <a
        href="#politicas"
        class="block text-slate-700 hover:text-emerald-600 transition-colors font-medium py-2 mobile-menu-link"
      >
        Políticas
      </a>
      <a
        href="https://wa.me/56952299793"
        target="_blank"
        class="block bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-3 rounded-full transition-colors text-center font-medium"
      >
        Reservar por WhatsApp
      </a>
    </div>
  </div>
</nav>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const navbar = document.getElementById("navbar");
  const mobileMenuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");
  const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");

  // Show navbar on scroll
  let lastScroll = 0;
  window.addEventListener("scroll", () => {
    const currentScroll = window.pageYOffset;

    if (currentScroll > 100) {
      navbar?.classList.remove("-translate-y-full");
    } else {
      navbar?.classList.add("-translate-y-full");
    }

    lastScroll = currentScroll;
  });

  // Mobile menu toggle
  mobileMenuButton?.addEventListener("click", () => {
    const isOpen = !mobileMenu?.classList.contains("hidden");

    if (isOpen) {
      mobileMenu?.classList.add("hidden");
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");
    } else {
      mobileMenu?.classList.remove("hidden");
      menuIcon?.classList.add("hidden");
      closeIcon?.classList.remove("hidden");
    }
  });

  // Close mobile menu when clicking a link
  mobileMenuLinks.forEach((link) => {
    link.addEventListener("click", () => {
      mobileMenu?.classList.add("hidden");
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");
    });
  });

  // Smooth scroll for anchor links
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      const target = document.querySelector(
        this.getAttribute("href") as string
      );
      if (target) {
        target.scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }
    });
  });
</script>
